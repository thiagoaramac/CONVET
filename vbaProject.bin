Option Explicit

            Private Declare PtrSafe Function OpenClipboard Lib "user32" (ByVal hwnd As LongPtr) As Long
            Private Declare PtrSafe Function CloseClipboard Lib "user32" () As Long
            Private Declare PtrSafe Function EmptyClipboard Lib "user32" () As Long
            Private Declare PtrSafe Function SetClipboardData Lib "user32" (ByVal wFormat As Long, ByVal hMem As LongPtr) As LongPtr
            Private Declare PtrSafe Function GlobalAlloc Lib "kernel32" (ByVal wFlags As Long, ByVal dwBytes As LongPtr) As LongPtr
            Private Declare PtrSafe Function GlobalLock Lib "kernel32" (ByVal hMem As LongPtr) As LongPtr
            Private Declare PtrSafe Function GlobalUnlock Lib "kernel32" (ByVal hMem As LongPtr) As Long
            Private Declare PtrSafe Function GlobalFree Lib "kernel32" (ByVal hMem As LongPtr) As LongPtr
            Private Declare PtrSafe Function lstrcpy Lib "kernel32" (ByVal lpStr1 As Any, ByVal lpStr2 As Any) As LongPtr

            Private Const CF_TEXT = 1&
            Private Const GMEM_MOVEABLE = &H2

            Sub CopyContent()
            Call StringToClipboard(ActiveCell.Value)
            End Sub

            Private Sub StringToClipboard(strText As String)
            Dim lngIdentifier As LongPtr, lngPointer As LongPtr
            lngIdentifier = GlobalAlloc(GMEM_MOVEABLE, Len(strText) + 1)
            lngPointer = GlobalLock(lngIdentifier)
            Call lstrcpy(ByVal lngPointer, strText)
            Call GlobalUnlock(lngIdentifier)
            Call OpenClipboard(0&)
            Call EmptyClipboard
            Call SetClipboardData(CF_TEXT, lngIdentifier)
            Call CloseClipboard
            Call GlobalFree(lngIdentifier)
            End Sub